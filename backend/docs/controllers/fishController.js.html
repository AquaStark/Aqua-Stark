<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: fishController.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: fishController.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { FishService } from '../services/fishService.js';

/**
 * Fish Controller
 *
 * Handles HTTP requests related to fish operations including state management,
 * happiness updates, feeding, statistics, and breeding operations.
 *
 * All methods follow a consistent response format:
 * - Success: { success: true, data: result, message?: string }
 * - Error: { error: string }
 *
 * @class FishController
 */
export class FishController {
  /**
   * Get fish state
   *
   * Retrieves the current state of a specific fish.
   * The resource is pre-validated by ownership middleware.
   *
   * @static
   * @async
   * @param {Object} req - Express request object
   * @param {Object} req.resource - Pre-validated fish resource from middleware
   * @param {Object} res - Express response object
   * @returns {Promise&lt;void>} JSON response with fish state data
   *
   * @example
   * // GET /api/fish/123/state
   * // Response: { success: true, data: { fishId: "123", happiness: 85, ... } }
   */
  static async getFishState(req, res) {
    try {
      // Resource is already validated by ownership middleware
      const fishState = req.resource;

      res.json({ success: true, data: fishState });
    } catch (error) {
      console.error('Error in getFishState:', error);
      res.status(500).json({ error: 'Internal server error' });
    }
  }

  /**
   * Update fish happiness
   *
   * Updates the happiness level of a specific fish.
   * Happiness must be between 0 and 100.
   *
   * @static
   * @async
   * @param {Object} req - Express request object
   * @param {Object} req.params - Request parameters
   * @param {string} req.params.fishId - Fish ID from URL
   * @param {Object} req.body - Request body
   * @param {number} req.body.happinessLevel - New happiness level (0-100)
   * @param {Object} res - Express response object
   * @returns {Promise&lt;void>} JSON response with updated fish data
   *
   * @example
   * // PUT /api/fish/123/happiness
   * // Body: { happinessLevel: 90 }
   * // Response: { success: true, data: { ... }, message: "Fish happiness updated to 90" }
   */
  static async updateFishHappiness(req, res) {
    try {
      const { fishId } = req.params;
      const { happinessLevel } = req.body;

      if (
        happinessLevel === undefined ||
        happinessLevel &lt; 0 ||
        happinessLevel > 100
      ) {
        return res
          .status(400)
          .json({ error: 'Happiness level must be between 0 and 100' });
      }

      const updatedFish = await FishService.updateFishHappiness(
        fishId,
        happinessLevel
      );

      res.json({
        success: true,
        data: updatedFish,
        message: `Fish happiness updated to ${happinessLevel}`,
      });
    } catch (error) {
      console.error('Error in updateFishHappiness:', error);
      res.status(500).json({ error: 'Internal server error' });
    }
  }

  /**
   * Feed fish
   *
   * Feeds a fish with specified food type, affecting happiness and growth.
   * Defaults to 'regular' food type if not specified.
   *
   * @static
   * @async
   * @param {Object} req - Express request object
   * @param {Object} req.params - Request parameters
   * @param {string} req.params.fishId - Fish ID from URL
   * @param {Object} req.body - Request body
   * @param {string} [req.body.foodType='regular'] - Type of food to feed
   * @param {Object} res - Express response object
   * @returns {Promise&lt;void>} JSON response with feeding result
   *
   * @example
   * // POST /api/fish/123/feed
   * // Body: { foodType: "premium" }
   * // Response: { success: true, data: { ... }, message: "Fish fed with premium food" }
   */
  static async feedFish(req, res) {
    try {
      const { fishId } = req.params;
      const { foodType = 'regular' } = req.body;

      const feedingResult = await FishService.feedFish(fishId, foodType);

      res.json({
        success: true,
        data: feedingResult,
        message: `Fish fed with ${foodType} food`,
      });
    } catch (error) {
      console.error('Error in feedFish:', error);
      res.status(500).json({ error: 'Internal server error' });
    }
  }

  /**
   * Get fish statistics
   *
   * Retrieves detailed statistics for a specific fish including growth, feeding history, etc.
   *
   * @static
   * @async
   * @param {Object} req - Express request object
   * @param {Object} req.params - Request parameters
   * @param {string} req.params.fishId - Fish ID from URL
   * @param {Object} res - Express response object
   * @returns {Promise&lt;void>} JSON response with fish statistics
   *
   * @example
   * // GET /api/fish/123/stats
   * // Response: { success: true, data: { totalFeedings: 15, growthRate: 1.2, ... } }
   */
  static async getFishStats(req, res) {
    try {
      const { fishId } = req.params;

      const stats = await FishService.getFishStats(fishId);

      if (!stats) {
        return res.status(404).json({ error: 'Fish not found' });
      }

      res.json({ success: true, data: stats });
    } catch (error) {
      console.error('Error in getFishStats:', error);
      res.status(500).json({ error: 'Internal server error' });
    }
  }

  /**
   * Breed fish
   *
   * Placeholder endpoint for fish breeding functionality.
   * Currently returns a "not implemented" response.
   *
   * @static
   * @async
   * @param {Object} req - Express request object
   * @param {Object} req.body - Request body
   * @param {string} req.body.parent1Id - ID of first parent fish
   * @param {string} req.body.parent2Id - ID of second parent fish
   * @param {Object} res - Express response object
   * @returns {Promise&lt;void>} JSON response indicating not implemented
   *
   * @example
   * // POST /api/fish/breed
   * // Body: { parent1Id: "123", parent2Id: "456" }
   * // Response: { error: "Not implemented", message: "Fish breeding will be implemented in a future update" }
   */
  static async breedFish(req, res) {
    try {
      const { parent1Id, parent2Id } = req.body;

      if (!parent1Id || !parent2Id) {
        return res
          .status(400)
          .json({ error: 'Both parent fish IDs are required' });
      }

      // This would be implemented when breeding is added
      res.status(501).json({
        error: 'Not implemented',
        message: 'Fish breeding will be implemented in a future update',
      });
    } catch (error) {
      console.error('Error in breedFish:', error);
      res.status(500).json({ error: 'Internal server error' });
    }
  }

  /**
   * Get all fish for a player
   *
   * Retrieves all fish belonging to a specific player.
   * Players can only access their own fish.
   *
   * @static
   * @async
   * @param {Object} req - Express request object
   * @param {Object} req.params - Request parameters
   * @param {string} req.params.playerId - Player ID from URL
   * @param {Object} req.user - Authenticated user data
   * @param {string} req.user.playerId - Authenticated player's ID
   * @param {Object} res - Express response object
   * @returns {Promise&lt;void>} JSON response with array of player's fish
   *
   * @example
   * // GET /api/players/123/fish
   * // Response: { success: true, data: [{ fishId: "456", species: "goldfish", ... }, ...] }
   */
  static async getPlayerFish(req, res) {
    try {
      const { playerId } = req.params;
      const { playerId: authenticatedPlayerId } = req.user;

      // Ensure player can only access their own fish
      if (playerId !== authenticatedPlayerId) {
        return res.status(403).json({ error: 'Access denied' });
      }

      const fish = await FishService.getPlayerFish(playerId);

      res.json({ success: true, data: fish });
    } catch (error) {
      console.error('Error in getPlayerFish:', error);
      res.status(500).json({ error: 'Internal server error' });
    }
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-controllers.html">controllers</a></li></ul><h3>Classes</h3><ul><li><a href="DecorationController.html">DecorationController</a></li><li><a href="FishController.html">FishController</a></li><li><a href="MinigameController.html">MinigameController</a></li><li><a href="PlayerController.html">PlayerController</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Thu Sep 11 2025 11:48:53 GMT+0100 (Horário Padrão da África Ocidental)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
